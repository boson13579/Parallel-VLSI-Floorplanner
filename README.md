# Parallel VLSI Floorplanner using Simulated Annealing

é€™æ˜¯ä¸€å€‹ä½¿ç”¨ C++ å’Œ OpenMP å¯¦ç¾çš„é«˜æ•ˆèƒ½ VLSI ä½ˆå±€è¦åŠƒå™¨ (Floorplanner)ã€‚å°ˆæ¡ˆçš„æ ¸å¿ƒæ˜¯åˆ©ç”¨ B*-Tree ä¾†è¡¨ç¤ºæ™¶ç‰‡ä½ˆå±€ï¼Œä¸¦é€éæ¨¡æ“¬é€€ç« (Simulated Annealing, SA) æ¼”ç®—æ³•ä¾†å°ä½ˆå±€é€²è¡Œæœ€ä½³åŒ–ã€‚ç‚ºäº†æ‡‰å°å¤§è¦æ¨¡é›»è·¯çš„æŒ‘æˆ°ï¼Œæœ¬å°ˆæ¡ˆæ¢ç´¢ä¸¦å¯¦ä½œäº†ä¸‰ç¨®ä¸åŒç²’åº¦çš„å¹³è¡ŒåŒ–ç­–ç•¥ã€‚

## âœ¨ ä¸»è¦åŠŸèƒ½

- **B\*-Tree è¡¨ç¤ºæ³•**: é«˜æ•ˆåœ°è¡¨ç¤ºéåˆ‡ç‰‡å¼ (Non-slicing) çš„ä½ˆå±€çµæ§‹ã€‚
- **æ¨¡æ“¬é€€ç«æœ€ä½³åŒ–**: å¼·å¤§çš„éš¨æ©Ÿæœå°‹æ¼”ç®—æ³•ï¼Œèƒ½å¤ è·³å‡ºå±€éƒ¨æœ€ä½³è§£ï¼Œå°‹æ‰¾å…¨åŸŸæœ€ä½³è§£ã€‚
- **å¤šç¨®å¹³è¡ŒåŒ–ç­–ç•¥**:
    1.  **ç²—ç²’åº¦ (Coarse-Grained)**: å¤šèµ·å§‹é»å¹³è¡Œæœå°‹ (Multi-Start SA)ã€‚
    2.  **ä¸­ç²’åº¦ (Medium-Grained)**: å¹³è¡Œå›ç« / è¤‡æœ¬äº¤æ› (Parallel Tempering)ã€‚
    3.  **ç´°ç²’åº¦ (Fine-Grained)**: å¹³è¡Œç§»å‹•ç”Ÿæˆ (Parallel Move Generation)ã€‚
- **æ•ˆèƒ½è©•ä¼°**: è‡ªå‹•å°‡ã€Œæ™‚é–“ vs. æœ€ä½³æˆæœ¬ã€çš„æ”¶æ–‚éç¨‹è¨˜éŒ„åˆ° CSV æª”æ¡ˆä¸­ï¼Œæ–¹ä¾¿é€²è¡Œè¦–è¦ºåŒ–åˆ†æã€‚
- **åƒæ•¸åŒ–è¨­è¨ˆ**: å°‡ SA çš„è¶…åƒæ•¸ï¼ˆæº«åº¦ã€é™æº«é€Ÿç‡ç­‰ï¼‰èˆ‡æ ¸å¿ƒé‚è¼¯åˆ†é›¢ï¼Œæ–¹ä¾¿é€²è¡Œå¯¦é©—èˆ‡èª¿æ ¡ã€‚

## ğŸ“ å°ˆæ¡ˆçµæ§‹

```
.
â”œâ”€â”€ inc/                    # å­˜æ”¾æ‰€æœ‰æ¨™é ­æª” (.h)
â”‚   â”œâ”€â”€ DataStructures.h
â”‚   â”œâ”€â”€ Floorplan.h
â”‚   â””â”€â”€ ParallelSA.h
â”œâ”€â”€ src/                    # å­˜æ”¾æ‰€æœ‰åŸå§‹æª” (.cpp)
â”‚   â”œâ”€â”€ Floorplan.cpp
â”‚   â”œâ”€â”€ ParallelSA.cpp
â”‚   â””â”€â”€ main.cpp
â”œâ”€â”€ testcase/               # æ¸¬è©¦æ¡ˆä¾‹
â”‚   â””â”€â”€ ...
â”œâ”€â”€ .gitignore              # Git å¿½ç•¥æ¸…å–®
â”œâ”€â”€ Makefile                # å°ˆæ¡ˆå»ºç½®è…³æœ¬
â””â”€â”€ README.md               # å°ˆæ¡ˆèªªæ˜æ–‡ä»¶
```

## ğŸ› ï¸ å»ºç½®èˆ‡åŸ·è¡Œ

### ç’°å¢ƒéœ€æ±‚

-   æ”¯æ´ C++17 çš„ç·¨è­¯å™¨ (ä¾‹å¦‚ `g++`)
-   OpenMP å‡½å¼åº«
-   `make` å»ºç½®å·¥å…·

### å»ºç½®å°ˆæ¡ˆ

åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„ä¸‹ï¼ŒåŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ï¼š

```bash
make
```

æ­¤æŒ‡ä»¤æœƒç·¨è­¯æ‰€æœ‰åŸå§‹æª”ï¼Œä¸¦åœ¨æ ¹ç›®éŒ„ç”¢ç”Ÿä¸€å€‹åç‚º `floorplanner` çš„å¯åŸ·è¡Œæª”ã€‚

### åŸ·è¡Œå°ˆæ¡ˆ

#### åŸºæœ¬åŸ·è¡Œ

ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤æ ¼å¼ä¾†åŸ·è¡Œç¨‹å¼ï¼š

```bash
./floorplanner -i <è¼¸å…¥æª”æ¡ˆè·¯å¾‘> -o <è¼¸å‡ºæª”æ¡ˆè·¯å¾‘>
```

**ç¯„ä¾‹ï¼š**
```bash
./floorplanner -i testcase/case1.block -o output/case1_output.block
```

#### æ§åˆ¶å¹³è¡ŒåŒ–

- **è¨­å®šåŸ·è¡Œç·’æ•¸é‡**: é€é `OMP_NUM_THREADS` ç’°å¢ƒè®Šæ•¸ä¾†æ§åˆ¶ä½¿ç”¨çš„åŸ·è¡Œç·’æ•¸ã€‚

  ```bash
  # ä½¿ç”¨ 8 å€‹åŸ·è¡Œç·’åŸ·è¡Œ
  OMP_NUM_THREADS=8 ./floorplanner -i testcase/case1.block -o output/case1_output.block
  ```

- **é¸æ“‡å¹³è¡ŒåŒ–ç­–ç•¥**: åœ¨ `src/main.cpp` æª”æ¡ˆä¸­ï¼Œä¿®æ”¹ `strategy` è®Šæ•¸çš„å€¼ä¾†é¸æ“‡ä¸åŒçš„å¹³è¡ŒåŒ–æ–¹æ³•ã€‚

  ```cpp
  // åœ¨ src/main.cpp ä¸­
  // ...
  ParallelizationStrategy strategy = ParallelizationStrategy::MultiStart_Coarse;
  // ParallelizationStrategy strategy = ParallelizationStrategy::ParallelTempering_Medium;
  // ParallelizationStrategy strategy = ParallelizationStrategy::ParallelMoves_Fine;
  // ...
  ```
  ä¿®æ”¹å¾Œéœ€è¦ä½¿ç”¨ `make` é‡æ–°ç·¨è­¯ã€‚

## ğŸ“Š æ•ˆèƒ½è©•ä¼°

ç¨‹å¼æ¯æ¬¡åŸ·è¡Œéƒ½æœƒç”¢ç”Ÿä¸€å€‹ `convergence_log.csv` æª”æ¡ˆã€‚é€™å€‹æª”æ¡ˆè¨˜éŒ„äº†éš¨è‘—æ™‚é–“æ¨ç§»ï¼Œæ¼”ç®—æ³•æ‰¾åˆ°çš„æœ€ä½³æˆæœ¬ã€‚